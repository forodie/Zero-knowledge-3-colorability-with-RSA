<center>

# Доказательство с нулевым разглашением на основе задачи о 3-х раскрашиваемом графе
    (Zero knowledge 3-colorability with RSA)

### ННГУ им. Н. И. Лобачевского
    N. I. Lobachevsky State University of Nizhny Novgorod
### Институт информационных технологий, математики и механики
    Institute of information technology, mathematics and mechanics
    
</center>

## Теория
Доказательство с нулевым разглашением с применением криптографического протокола RSA на основе задачи о 3-х раскрашиваемом графе. 

Пусть имеется граф $G=(V,E)$ и $\chi(G)=3,$ где $V = \{v_1,v_2,\dots,v_k\}$ и доказывающему известна раскраска графа (Таблица `T`). 


| $v_1$    | $v_2$    | $\dots$ | $v_k$    |
|----------|----------|---------|----------|
| $c(v_1)$ | $c(v_2)$ | $\dots$ | $c(v_k)$ |

где $c(v_i) \in \{R,G,B\}, i = \overline{1,k}.$

Верификатор (Verifier) в свою очередь знает только сам граф или матрицу смежности. Prover хочет доказать Verifier'y то, что знает правильную раскраску графа, не предъявляя саму раскраску.

Протокол состоит в следующем:
1. Prover выбирает случайную перестановку $\pi$ из $\{ R,G,B \}$ и формирует новую таблицу $\widetilde{T}$ раскраски графа:  

| $v_1$         | $v_2$         | $\dots$ | $v_k$         |
|---------------|---------------|---------|---------------|
| $\pi(c(v_1))$ | $\pi(c(v_2))$ | $\dots$ | $\pi(c(v_k))$ |
  
  Для каждой вершины $v \in V$ Prover генерирует большое случайное число $r_v$ и преобразовывает по следующему правилу ($r_v := r_v'$):

- Если вершина $v$ в таблице $\widetilde{T}$ окрашена в $R,$ то меняем последние два бита на $00.$
- Если вершина $v$ в таблице $\widetilde{T}$ окрашена в $G,$ то меняем последние два бита на $01.$
- Если вершина $v$ в таблице $\widetilde{T}$ окрашена в $B,$ то меняем последние два бита на $10.$

    Для каждой вершины $v \in V$ Prover формирует параметры для алгоритма RSA:
	
    Генерирует простые числа $p_v$ и $q_v,$ вычисляет $n_v = p_v \cdot q_v$ и функцию Эйлера $\varphi(n_v)=(p_v-1)(q_v-1).$ 

    Затем выбирает такое $e_v,$ что $1\le e_v \le \varphi(n_v)\text{ и }\gcd(e_v,\varphi(n_v))=1.$
    
    Вычисляет число $d_v,$ мультипликативно обратное к числу $e_v$ по модулю $\varphi(n_v),$ то есть удовлетворяющее сравнению $d_v \cdot e_v \equiv 1 \,\mathrm{mod}\,\varphi(n_v).$

    Вычисляет число $m_v=r_v^{e_v} \,\mathrm{mod}\,n_v.$ Затем формирует и посылает следующую таблицу Verifier'y:

| $v_1$         | $v_2$         | $\dots$ | $v_k$         |
|---------------|---------------|---------|---------------|
| $n_1,e_1,m_1$ | $n_2,e_2,m_2$ | $\dots$ | $n_k,e_k,m_k$ |

2. Verifier случайно выбирает ребро $(u^*,u')\in E$ и сообщает его Prover'y.
3. В ответ Prover присылает Verifier'y числа $d_{u^*}$ и $d_{u'},$ которые соответствуют вершинам выбранного ребра. После чего абонент вычисляет:
$$\widetilde{m}_{u^*}=m_{u^*}^{d_{u^*}} \,\mathrm{mod}\,n_{u^*} = r_{u^*} \text{ и } \widetilde{m}_{u'} = m_{u'}^{d_{u'}} \,\mathrm{mod}\,n_{u'} = r_{u'},$$
затем сравнивает два последних бита в этих числах. При правильной раскраске два последних бита должны быть различны. Если они получились одинаковыми, значит Prover попытался обмануть (не знает раскраски). Если различны, то все шаги повторяются $\mu\cdot|E|$ раз, где $\mu>0$ некоторый параметр, характеризующий точность.


Пусть $p$ вероятность того, что доказывающий не обманул проверяющего и знает правильную раскраску в 3 цвета. Тогда количествово шагов $k$, которое необходимо для достижения такой границы достоверности удовлетворяет неравенству: $$1-\left(1-\frac{1}{|E|}\right)^k > p.$$

Решив его, найдём, что $$\frac{\ln(1-p)}{\ln\left(1-\frac{1}{|E|}\right)} < k.$$

Используя неравенство $\left(1-\frac{1}{x}\right)^{a\cdot x} < e^{-a}$  и взяв $k=[\mu\cdot|E|]$ (квадратные скобки это целая часть от числа) получаем, что вероятность достоверности: $$1-\left(1-\frac{1}{E}\right)^{\mu \cdot |E|} > 1-e^{-\mu}.$$

Если хотим, чтобы $1-e^{-\mu} > p,$ то коэффициент $\mu$ надо взять: $$\ln\left(\frac{1}{1-p}\right) < \mu.$$

Например, чтобы $p = 0.90, $ то $\mu$ нужно взять равной примерно $2.31.$ Соответственно число $k = [2.31\cdot|E|].$
